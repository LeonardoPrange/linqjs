function EqualityComparer(r,t){return r===t||r.valueOf()===t.valueOf()}function SortComparer(r,t){return r===t?0:null==r?-1:null==t?1:"string"==typeof r?r.toString().localeCompare(t.toString()):r.valueOf()-t.valueOf()}function Predicate(){return!0}function Selector(r){return r}Array.prototype.select=Array.prototype.map||function(r,t){t=t||global||window;for(var n=[],e=this.length,o=0;e>o;o++)n.push(r.call(t,this[o],o,this));return n},Array.prototype.selectMany=function(r,t){return t=t||function(r,t){return t},this.aggregate(function(n,e){return n.concat(r(e).select(function(r){return t(e,r)}))},[])},Array.prototype.take=function(r){return this.slice(0,r)},Array.prototype.skip=Array.prototype.slice,Array.prototype.first=function(r,t){var n=this.length;if(!r)return n?this[0]:null==t?null:t;for(var e=0;n>e;e++)if(r(this[e],e,this))return this[e];return null==t?null:t},Array.prototype.last=function(r,t){var n=this.length;if(!r)return n?this[n-1]:null==t?null:t;for(;n-->0;)if(r(this[n],n,this))return this[n];return null==t?null:t},Array.prototype.union=function(r){return this.concat(r).distinct()},Array.prototype.intersect=function(r,t){return t=t||EqualityComparer,this.distinct(t).where(function(n){return r.contains(n,t)})},Array.prototype.except=function(r,t){r instanceof Array||(r=[r]),t=t||EqualityComparer;for(var n=this.length,e=[],o=0;n>o;o++){for(var i=r.length,u=!1;i-->0;)if(t(this[o],r[i])===!0){u=!0;break}u||e.push(this[o])}return e},Array.prototype.distinct=function(r){for(var t=[],n=this.length,e=0;n>e;e++)t.contains(this[e],r)||t.push(this[e]);return t},Array.prototype.zip=function(r,t){return this.take(Math.min(this.length,r.length)).select(function(n,e){return t(n,r[e])})},Array.prototype.indexOf=Array.prototype.indexOf||function(r,t){for(var n=this.length,e=Math.max(Math.min(t,n),0)||0;n>e;e++)if(this[e]===r)return e;return-1},Array.prototype.lastIndexOf=Array.prototype.lastIndexOf||function(r,t){for(var n=Math.max(Math.min(t||this.length,this.length),0);n-->0;)if(this[n]===r)return n;return-1},Array.prototype.remove=function(r){var t=this.indexOf(r);-1!=t&&this.splice(t,1)},Array.prototype.removeAll=function(r){for(var t,n=0;null!=(t=this.first(r));)n++,this.remove(t);return n},Array.prototype.orderBy=function(r,t){t=t||SortComparer;var n=this.slice(0),e=function(n,e){return t(r(n),r(e))};return n.thenBy=function(r,t){return t=t||SortComparer,n.orderBy(Selector,function(n,o){var i=e(n,o);return 0===i?t(r(n),r(o)):i})},n.thenByDescending=function(r,t){return t=t||SortComparer,n.orderBy(Selector,function(n,o){var i=e(n,o);return 0===i?-t(r(n),r(o)):i})},n.sort(e)},Array.prototype.orderByDescending=function(r,t){return t=t||SortComparer,this.orderBy(r,function(r,n){return-t(r,n)})},Array.prototype.innerJoin=function(r,t,n,e,o){o=o||EqualityComparer;var i=[];return this.forEach(function(u){r.where(function(r){return o(t(u),n(r))}).forEach(function(r){i.push(e(u,r))})}),i},Array.prototype.groupJoin=function(r,t,n,e,o){return o=o||EqualityComparer,this.select(function(e){var i=t(e);return{outer:e,inner:r.where(function(r){return o(i,n(r))}),key:i}}).select(function(r){return r.inner.key=r.key,e(r.outer,r.inner)})},Array.prototype.groupBy=function(r,t){var n=[],e=this.length;t=t||EqualityComparer,r=r||Selector;for(var o=0;e>o;o++){var i=r(this[o]),u=n.first(function(r){return t(r.key,i)});u||(u=[],u.key=i,n.push(u)),u.push(this[o])}return n},Array.prototype.toDictionary=function(r,t){for(var n={},e=this.length;e-->0;){var o=r(this[e]);null!=o&&""!==o&&(n[o]=t(this[e]))}return n},Array.prototype.aggregate=Array.prototype.reduce||function(r,t){var n=this.slice(0),e=this.length;null==t&&(t=n.shift());for(var o=0;e>o;o++)t=r(t,n[o],o,this);return t},Array.prototype.min=function(r){r=r||Selector;for(var t=this.length,n=r(this[0]);t-->0;)r(this[t])<n&&(n=r(this[t]));return n},Array.prototype.max=function(r){r=r||Selector;for(var t=this.length,n=r(this[0]);t-->0;)r(this[t])>n&&(n=r(this[t]));return n},Array.prototype.sum=function(r){r=r||Selector;for(var t=this.length,n=0;t-->0;)n+=r(this[t]);return n},Array.prototype.where=Array.prototype.filter||function(r,t){t=t||global||window;for(var n=[],e=this.length,o=0;e>o;o++)r.call(t,this[o],o,this)===!0&&n.push(this[o]);return n},Array.prototype.any=function(r,t){t=t||global||window;var n=this.some||function(r,t){var n=this.length;if(!r)return n>0;for(;n-->0;)if(r.call(t,this[n],n,this)===!0)return!0;return!1};return n.apply(this,[r,t])},Array.prototype.all=function(r,t){t=t||global||window,r=r||Predicate;var n=this.every||function(r,t){return this.length==this.where(r,t).length};return n.apply(this,[r,t])},Array.prototype.takeWhile=function(r){r=r||Predicate;for(var t=this.length,n=[],e=0;t>e&&r(this[e],e)===!0;e++)n.push(this[e]);return n},Array.prototype.skipWhile=function(r){r=r||Predicate;var t=this.length,n=0;for(n=0;t>n&&r(this[n],n)!==!1;n++);return this.skip(n)},Array.prototype.contains=function(r,t){t=t||EqualityComparer;for(var n=this.length;n-->0;)if(t(this[n],r)===!0)return!0;return!1},Array.prototype.forEach=Array.prototype.forEach||function(r,t){t=t||global||window;for(var n=this.length,e=0;n>e;e++)r.call(t,this[e],e,this)},Array.prototype.defaultIfEmpty=function(r){return 0===this.length?[null===r?null:r]:this},Array.range=function(r,t){for(var n=[];t-->0;)n.push(r++);return n};